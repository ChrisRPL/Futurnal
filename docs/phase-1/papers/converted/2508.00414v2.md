# 2508.00414v2.pdf

Technical Report
Cognitive Kernel-Pro: A Framework for Deep Research Agents and
Agent Foundation Models Training
Tianqing Fang∗, Zhisong Zhang∗, Xiaoyang Wang, Rui Wang, Can Qin, Yuxuan Wan, Jun-Yu Ma,
Ce Zhang, Jiaqi Chen, Xiyun Li, Hongming Zhang, Haitao Mi, Dong Yu
Tencent AI Lab
/gtbhttps://github.com/Tencent/CognitiveKernel-Pro
GAIA
0
10
20
30
40
50
60
70
80
 Pass@1
Voting
Pass@3
GAIA-text
0
10
20
30
40
50
60
WebDancer 7B WebSailor 7B
Pass@1 Pass@3
OAgentDeepResearchOWLManus
Proprietary Agent 
&  Charged Tools
Open-Source Agent 
& Free Tools
Cognitive Kernel-Pro
CK-Pro-8B Claude-3.7
75.2
66.1
60.0
66.1
52.752.7
66.7 67.4 69.1
73.9
N/A
35.2 37.0
45.4
44.7
53.4
31.0
34.0
37.9
CK-Pro-8B
(a) (b)
Claude-3.7
Smolagents
Figure 1: (a) Performance comparison on the full GAIA development set (number of examples
n=165). The left panel presents results from our open-source Cognitive Kernel-Pro framework,
utilizing our Qwen3-8B SFT model and Claude-3.7 as foundation models with exclusively free tools.
The right panel displays Pass@1 scores for proprietary agents and open-source systems employing
paid tools. (b) Performance on the text-only GAIA subset (n=103), demonstrating our 8B model’s
superiority over 7B models in the WebDancer/WebSailor family (∼2% higher Pass@1, over 10%
higher Pass@3).
Abstract
General AI Agents are increasingly recognized as foundational frameworks for the
next generation of artificial intelligence, enabling complex reasoning, web interaction,
coding, and autonomous research capabilities. However, current agent systems are
either closed-source or heavily reliant on a variety of paid APIs and proprietary tools,
limiting accessibility and reproducibility for the research community. In this work,
we present Cognitive Kernel-Pro, a fully open-source and (to the maximum extent)
free multi-module agent framework designed to democratize the development and
evaluation of advanced AI agents. Within Cognitive Kernel-Pro, we systematically
investigate the curation of high-quality training data for Agent Foundation Models,
focusing on the construction of queries, trajectories, and verifiable answers across
four key domains: web, file, code, and general reasoning. Furthermore, we explore
novel strategies for agent test-time reflection and voting to enhance agent robustness
and performance. We evaluate Cognitive Kernel-Pro on GAIA, achieving state-of-
the-art results among open-source and free agents. Notably, our 8B-parameter open-
source model surpasses previous leading systems such as WebDancer and WebSailor,
establishing a new performance standard for accessible, high-capability AI agents.
Note: The term Cognitive Kernel (Zhang et al., 2024) refers to the core computational
framework of the agent, designed to emulate the cognitive processes of the human mind.
∗Equal Core Contributors. Correspondence: tianqfang@tencent.com
1
arXiv:2508.00414v2  [cs.AI]  12 Aug 2025Technical Report
CogKernel (Zhang et al, 2024)
(Open)WebVoyager (He et al, 2024)
Agent Framework 
CogKernel-ProAgent Data
Agent Foundation 
Model Post-Training
DocBench (Zou et al, 2024)
PersonHub (Ge et al, 2024)
WebEvolver (Fang et al, 2025)
WebCoT (Hu et al, 2025)
CK-Pro-8B (Qwen-3)
Hierarchical Multi -Agent Structure
Planner-Action Interaction  (§2.1)
Multi-Hop URLQA (§3.1)
AgentWebQA (§3.2)
PersonaHub Augmentation (§3.3)
Reasoning, Coding, etc (§3.4)
+ 
+ 
Reflection & Planning (§2.2)+ 
Figure 2: Technical roadmap showcasing prior innovations from Tencent AI Lab (Cognitive Ker-
nel; Zhang et al., 2024, WebVoyager; He et al., 2024a, etc) and their integration toCognitive Kernel-
Pro via three core components, agent framework development, agent data construction, and agent
foundation model training. Yellow blocks highlight novel contributions in this work and the corre-
sponding section numbers.
1 Introduction
The rapid advancement of Deep Research Agents (Monica.Im, 2025; OpenAI, 2025) has transformed
the landscape of automated knowledge discovery and problem-solving. These agents, powered by
large language models (LLMs) and vision-language models (VLMs), excel in tasks such as coding,
web navigation, file processing, and complex reasoning. However, efforts toward fully open-source
agent frameworks (Roucher et al., 2025; Wu et al., 2025a; Li et al., 2025a) remain limited. Existing
open-source implementations (Zhu et al., 2025a; Hu et al., 2025a) often rely on proprietary tools
like Jina Reader, FireCrawl, or Chunkr to achieve competitive performance, creating barriers to
accessibility and reproducibility, or lack of multimodal or general agentic abilities (Wu et al., 2025a;
Li et al., 2025a). This dependency on paid tools underscores the need for a robust, fully open-
source framework that maximizes the inherent capabilities of LLMs and VLMs without external
dependencies.
To address this gap, we proposeCognitive Kernel-Pro, a multi-module, hierarchical agent frame-
work designed to facilitate fully open-source agent development. Cognitive Kernel-Pro leverages
Python code as its action space, harnessing the full reasoning and code-generation potential of
modern LLMs. The framework adopts a modular architecture, featuring a main agent that orches-
trates specialized sub-agents for web navigation, file handling, and tool invocation. Each module
operates independently, ensuring modularity and extensibility while simplifying the collection
of task-specific training data. By minimizing reliance on proprietary tools, Cognitive Kernel-Pro
emphasizes the intrinsic capabilities of Agent Foundation Models.
In addition to the framework, we introduce a comprehensive training recipe tailored for Cognitive
Kernel-Pro, covering diverse domains such as web navigation, file processing, code generation, and
reasoning. Our approach includes the construction of verifiable agent query-answer pairs, ensuring
high-quality training data. To enhance data collection, we incorporate intermediate process hints
and employ hint-based rejection sampling, which significantly improves the quality and relevance
of the collected data. This structured training methodology enables Cognitive Kernel-Pro to achieve
robust performance across diverse tasks while maintaining full open-source compatibility.
2Technical Report
Agent Class
completed_list
todo_list
experience
information
Planner
Action
Thought: … my thought
code:
```python
task="my task"
print(web_agent(task))
```
Task 
(str)
Output 
(str)
Main
Agent
Web
Agent
File
Agent
Tool 
Calling
Code
CogKernel-Pro Agent Framework
click
goto
type
goback
restart
scroll_up
scroll_down screenshot
read_text
read_multimodal
search
Search API
ask_llm
Multimodal Model Required
Reflection
Module
retry
task
Trajectory
return
Env.
Obs.
web
doc
Python
code
Text-only Mod el or Multimodal Model
Figure 3: Overview of the Cognitive Kernel-Pro Agent Framework. The left panel illustrates the
functionality of agent class, where the main agent, web agent, and file agent inherit from the
common base class. The planner maintains a state dictionary containing ‘completed_list’, ‘todo_list’,
‘experience’, and ‘information’ (§2.1). The action generator produces Python code as a code agent or
invokes predefined functions of sub-agents, such as the web agent, as well as other built-in tools.
The right panel illustrates the hierarchical structure of Cognitive Kernel-Pro, listing all functions
defined by each agent. Additionally, a standalone reflection module is included to assess task
completion; if the task is incomplete, the agent will retry (§2.2). The agent foundation model behind
each module/sub-agent is the same.
Furthermore, we explore inference-time optimization techniques to address the inherent random-
ness in tasks like web browsing. To mitigate variability, we propose a pipeline that integrates retry
mechanisms and ensemble-based multi-run strategies. This approach enhances the reliability and
consistency of Cognitive Kernel-Pro’s performance, particularly in dynamic and unpredictable envi-
ronments. By combining a modular framework, a robust training recipe, and optimized inference
strategies, Cognitive Kernel-Pro sets a new standard for open-source agent development, paving the
way for accessible and reproducible advancements in agent-based research.
2 Cognitive Kernel-Pro Framework
We present an overview of the Cognitive Kernel-Pro framework in Figure 3.
2.1 Architecture
We adopt a two-tier multi-module framework in our agent implementation. This framework
consists of a main agent, responsible for task decomposition, sub-task delegation, and information
aggregation, tool calling, code generation, as well as several sub-agents, whose objective is to solve
the sub-tasks assigned by the main agent. Both the main agent and sub-agents inherit from the same
base class, where the input is a task string, the output is a response string, and intermediate actions
are executed as Python code.
Main-Agent. The main agent directly manages the problem-solving process towards achieving the
overall goal. It decomposes the original complex tasks into manageable sub-tasks and assigns these
to sub-agents as needed. Upon receiving responses from the sub-agents, the main agent aggregates
the information and continues with the main procedure. Notably, the main agent does not possess
specialized skills such as web browsing or file processing; only the sub-agents (e.g., the web agent
and the file agent) are equipped with such capabilities. Nevertheless, the main agent is aware of the
functionalities of the sub-agents and is in charge of delegating appropriate sub-tasks accordingly.
3